# SQL и получение данных
## Цель: Научиться создавать запросы разного уровня сложности, получая данные из нескольких таблиц одновременно. Научится работать с системой PostgreSQL.

### Данные
Демонстрационная база данных "Авиаперевозки" для СУБД PostgreSQL. Описание таблиц приведено [тут](https://edu.postgrespro.ru/bookings.pdf). ERP-диаграмма базы данных приведена на изображении ![ERP]()

### Задача: 
1. Выведите название самолетов, которые имеют менее 50 посадочных мест?
2. Выведите процентное изменение ежемесячной суммы бронирования билетов, округленной до сотых.
3. Выведите названия самолетов не имеющих бизнес - класс. Решение должно быть через функцию array_agg.
4. Вывести накопительный итог количества мест в самолетах по каждому аэропорту на каждый день, учитывая только те самолеты, которые летали пустыми и только те дни, где из одного аэропорта таких самолетов вылетало более одного.
 *В результате должны быть код аэропорта, дата, количество пустых мест в самолете и накопительный итог.*
5. Найдите процентное соотношение перелетов по маршрутам от общего количества перелетов.
* Выведите в результат названия аэропортов и процентное отношение.*
 *Решение должно быть через оконную функцию.*
1. Выведите количество пассажиров по каждому коду сотового оператора, если учесть, что код оператора - это три символа после +7
2. Классифицируйте финансовые обороты (сумма стоимости перелетов) по маршрутам:
 До 50 млн - low
 От 50 млн включительно до 150 млн - middle
 От 150 млн включительно - high
 *Выведите в результат количество маршрутов в каждом полученном классе.*
1. Вычислите медиану стоимости перелетов, медиану размера бронирования и отношение медианы бронирования к медиане стоимости перелетов, округленной до сотых
2. Найдите значение минимальной стоимости полета 1 км для пассажиров. То есть нужно найти расстояние между аэропортами и с учетом стоимости перелетов получить искомый результат

### Решение
Используя функции, CTE, join были созданы запросы разного уровня сложности. Ознакомиться с запросами можно в [файле]().

### Инструменты
DBeaver

